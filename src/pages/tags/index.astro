---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';
import { filterDrafts } from '../../lib/utils';

const posts = filterDrafts(await getCollection('blog'));
const tagMap = new Map<string, number>();
posts.forEach((post) => {
  post.data.tags?.forEach((tag) => {
    tagMap.set(tag, (tagMap.get(tag) ?? 0) + 1);
  });
});
const tags = Array.from(tagMap.entries()).sort(([a], [b]) => a.localeCompare(b));
---
<BaseLayout title="标签" description="查看所有标签与文章数量。">
  <h1 class="text-3xl font-bold text-gray-900">标签</h1>
  <p class="mt-2 text-gray-700">探索你感兴趣的主题。</p>

  <ul class="mt-6 flex flex-wrap gap-3" aria-label="标签列表">
    {tags.map(([tag, count]) => (
      <li>
        <a
          class="rounded-full bg-blue-50 px-4 py-2 text-sm font-semibold text-primary shadow-sm"
          href={`/tags/${tag}/`}
        >
          #{tag} ({count})
        </a>
      </li>
    ))}
  </ul>
</BaseLayout>
